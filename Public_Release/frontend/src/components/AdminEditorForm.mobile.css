@media (max-width: 520px) {
  /* Scope to admin-profile-edit modal only (edit admin profile) */
  .modal-content.admin-profile-edit .modal-header {
    display: flex;
    gap: 0.6rem;
    align-items: flex-start;
    /* allow header to wrap naturally when name is long */
    flex-wrap: nowrap;
  }

  /* Force title/subtitle and the reset button to occupy a fixed 40vw width */
  .modal-content.admin-profile-edit .modal-title,
  .modal-content.admin-profile-edit .modal-subtitle,
  .modal-content.admin-profile-edit .modal-action-role,
  .modal-content.admin-profile-edit .modal-action-name,
  .modal-content.admin-profile-edit .header-reset-btn,
  .modal-content.admin-profile-edit .reset-btn {
    width: 40vw;
    max-width: 40vw;
    box-sizing: border-box;
    display: block;
    white-space: normal; /* allow wrapping */
    overflow: visible;
  }

  /* small visual spacing tweak so the reset button sits clearly below the title line */
  .modal-content.admin-profile-edit .header-reset-btn {
    margin-top: 0.4rem;
    padding: 0.45rem 0.65rem;
  }

  /* ensure the title block doesn't collapse if long name present */
  .modal-content.admin-profile-edit .modal-title h3 {
    margin: 0;
    line-height: 1.1;
  }

  /* keep avatar preview compact so header elements align neatly */
  .modal-content.admin-profile-edit .avatar-preview {
    flex: 0 0 auto;
    width: 56px;
    height: 56px;
  }

  /* in case the modal-header default uses column layout, prefer row for this variant */
  .modal-content.admin-profile-edit .modal-header .modal-title {
    flex: 0 0 40vw;
  }

  /* Reduce vertical gap between labels and their inputs to 2px for Add Viewer /
   * Add Server Admin modal on mobile. This targets label -> input/select/textarea
   * pairs inside .form-group and only applies to .add-viewer-wide modals.
   */
  .modal-content.add-viewer-wide .modal-form .form-group label {
    display: block;
    margin-bottom: 2px; /* requested 2px gap */
  }

  .modal-content.add-viewer-wide .modal-form .form-group > input,
  .modal-content.add-viewer-wide .modal-form .form-group > select,
  .modal-content.add-viewer-wide .modal-form .form-group > textarea {
    margin-top: 0; /* prevent extra top margin that increases gap */
    margin-bottom: 0; /* keep control spacing controlled by form-group */
    padding-top: 6px;
    padding-bottom: 6px;
  }

  /* When Reset is activated on small screens, expand modal height and make body scrollable
     so the reset inputs can be accessed without sticky actions blocking content. */
  .modal-content.full-height-reset {
    height: 97vh !important;
    max-height: 97vh !important;
    overflow: hidden; /* keep outer container clipped while inner body scrolls */
  }

  .modal-content.full-height-reset .modal-body,
  .modal-content.full-height-reset .modal-form {
    /* reserve space for header + actions; chosen 110px keeps title & actions visible */
    max-height: calc(97vh - 110px) !important;
    overflow-y: auto !important;
    -webkit-overflow-scrolling: touch;
  }

  /* Specific: when editing an ADMIN on mobile and Reset is activated, use 87vh */
  .modal-content.admin-profile-edit.full-height-reset {
    height: 72vh !important;
    max-height: 72vh !important;
    overflow: hidden !important;
  }

  
  /* Ensure actions flow with the content (not sticky/anchored) when full-height reset is active */
  /* Stronger selector to override sticky actions in App.css for admin-profile-edit when full-height reset is active */
  .modal-content.admin-profile-edit.full-height-reset .modal-actions,
  .modal-content.full-height-reset .modal-actions {
    position: static !important;
    bottom: auto !important;
    box-shadow: none !important;
    margin-top: 8px !important;
  }
}

/* Desktop: when editing an ADMIN and Reset is activated, make the modal body scrollable
   so the reset fields can be reached without changing overall modal size. */
.modal-content.admin-profile-edit.full-height-reset .modal-body,
.modal-content.admin-profile-edit.full-height-reset .modal-form {
  /* keep within the global modal max (80vh) but reserve space for header+actions */
  max-height: calc(80vh - 140px) !important;
  overflow-y: auto !important;
  -webkit-overflow-scrolling: touch;
}

/* On desktop, make the actions sticky and animate them when the reset flow is active.
   Keep mobile behavior unchanged (mobile rules set position: static). */
.modal-content.admin-profile-edit.full-height-reset .modal-actions {
  position: sticky !important;
  bottom: calc(env(safe-area-inset-bottom, 12px) + 12px) !important;
  margin-top: 8px !important;
  z-index: 60 !important;
  display: flex !important;
  gap: 0.75rem !important;
  justify-content: flex-end !important;
  background: rgba(15,31,46,0.02) !important; /* subtle backdrop so actions read above content */
  padding: 8px 10px !important;
  border-radius: 10px !important;
  box-shadow: 0 8px 20px rgba(2,8,12,0.18) !important;
  animation: modalActionsIn 220ms cubic-bezier(.2,.9,.3,1) both;
}

@keyframes modalActionsIn {
  from { transform: translateY(8px); opacity: 0; }
  to   { transform: translateY(0); opacity: 1; }
}
