name: Validate installer scripts

on:
  push: {}
  pull_request: {}

jobs:
  lint-bash:
    name: Bash installer lint
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Bash syntax check (bash -n)
        run: |
          if [ -f scripts/install.sh ]; then
            bash -n scripts/install.sh
          else
            echo "scripts/install.sh not found; skipping"
          fi

      - name: Install ShellCheck
        run: sudo apt-get update -y && sudo apt-get install -y shellcheck

      - name: Run ShellCheck on installer
        run: |
          if [ -f scripts/install.sh ]; then
            shellcheck -x scripts/install.sh || true
          else
            echo "scripts/install.sh not found; skipping"
          fi

  lint-powershell:
    name: PowerShell installer lint
    runs-on: windows-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Install PSScriptAnalyzer
        shell: pwsh
        run: |
          Install-Module -Name PSScriptAnalyzer -Force -Scope CurrentUser -Confirm:$false

      - name: Analyze PowerShell installer
        shell: pwsh
        run: |
          if (Test-Path -Path .\scripts\install-windows.ps1) {
            Invoke-ScriptAnalyzer -Path .\scripts\install-windows.ps1
          } else {
            Write-Host "scripts/install-windows.ps1 not found; skipping"
          }
